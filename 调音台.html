<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰∏ì‰∏öÈü≥È¢ëË∞ÉÈü≥Âè∞Ê®°ÊãüÂô® - ÂÆåÊï¥Áâà</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            overflow-x: auto;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            font-size: 2.2rem;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .mode-selector {
            display: flex;
            gap: 10px;
        }

        .mode-btn {
            padding: 8px 20px;
            border: none;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #ff8a00, #e52e71);
            color: white;
            box-shadow: 0 0 15px rgba(255, 138, 0, 0.5);
        }

        .mode-btn:not(.active) {
            background: rgba(255, 255, 255, 0.1);
            color: #a0a0c0;
        }

        .mode-btn:not(.active):hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .mixer-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .channels-section {
            flex: 3;
            min-width: 0;
        }

        .channels-container {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 10px 5px;
        }

        .channel {
            background: rgba(30, 30, 46, 0.9);
            border-radius: 8px;
            padding: 15px;
            width: 140px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s, box-shadow 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
        }

        .channel:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .channel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .channel-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #ff8a00;
        }

        .channel-meter {
            width: 8px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .channel-meter-level {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: linear-gradient(to top, #00ff00, #ffff00, #ff0000);
            transition: height 0.1s;
            height: 0%;
        }

        .channel-controls {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .input-source {
            margin-bottom: 10px;
        }

        .drop-zone {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 10px 5px;
            text-align: center;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.7rem;
            height: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .drop-zone:hover {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .drop-zone p {
            margin: 2px 0;
        }

        .drop-zone .file-icon {
            font-size: 1rem;
            margin-bottom: 5px;
            color: #4CAF50;
        }

        .mic-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            border: none;
            color: white;
            padding: 6px 10px;
            text-align: center;
            text-decoration: none;
            display: block;
            font-size: 0.7rem;
            margin: 5px auto 0;
            cursor: pointer;
            border-radius: 15px;
            transition: all 0.3s;
            width: 90%;
        }

        .mic-btn:hover {
            background: linear-gradient(135deg, #2980b9, #3498db);
            transform: scale(1.05);
        }

        .mic-btn.active {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .control-group {
            margin-bottom: 10px;
        }

        .control-label {
            font-size: 0.75rem;
            color: #a0a0c0;
            margin-bottom: 5px;
            text-align: center;
        }

        .fader {
            height: 120px;
            width: 100%;
            position: relative;
            display: flex;
            justify-content: center;
        }

        .fader-track {
            width: 6px;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            position: relative;
        }

        .fader-thumb {
            width: 20px;
            height: 12px;
            background: #ff8a00;
            border-radius: 3px;
            position: absolute;
            left: -7px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .knob {
            width: 40px;
            height: 40px;
            margin: 0 auto;
            position: relative;
        }

        .knob-dial {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: #333;
            border: 2px solid #555;
            position: relative;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }

        .knob-indicator {
            width: 2px;
            height: 15px;
            background: #ff8a00;
            position: absolute;
            top: 3px;
            left: 50%;
            transform: translateX(-50%);
            transform-origin: bottom center;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .channel-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 6px 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 0.7rem;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s;
            flex: 1;
            margin: 0 2px;
        }

        .channel-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .channel-btn.active {
            background: #ff8a00;
        }

        .master-section {
            flex: 1;
            min-width: 350px;
            background: rgba(30, 30, 46, 0.9);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
        }

        .master-controls {
            flex: 1;
        }

        .master-title {
            color: #ff8a00;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            font-size: 1.5rem;
        }

        .master-fader {
            height: 200px;
            width: 60px;
            margin: 0 auto 20px;
            position: relative;
        }

        .master-fader-track {
            width: 10px;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            position: relative;
            margin: 0 auto;
        }

        .master-fader-thumb {
            width: 30px;
            height: 20px;
            background: #ff8a00;
            border-radius: 5px;
            position: absolute;
            left: -10px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .eq-section {
            margin-bottom: 25px;
        }

        .eq-title {
            color: #3498db;
            margin-bottom: 15px;
            font-size: 1.1rem;
            text-align: center;
        }

        .eq-bands {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .eq-band {
            text-align: center;
        }

        .filter-section {
            margin-bottom: 25px;
        }

        .filter-title {
            color: #9b59b6;
            margin-bottom: 15px;
            font-size: 1.1rem;
            text-align: center;
        }

        .filter-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .filter-slider {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-slider label {
            font-size: 0.8rem;
            width: 60px;
        }

        .filter-slider input {
            flex: 1;
        }

        .gain-section {
            margin-bottom: 25px;
        }

        .gain-title {
            color: #2ecc71;
            margin-bottom: 15px;
            font-size: 1.1rem;
            text-align: center;
        }

        .gain-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .gain-slider {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .gain-slider label {
            font-size: 0.8rem;
            width: 60px;
        }

        .gain-slider input {
            flex: 1;
        }

        .transport-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .transport-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .play-btn {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }

        .play-btn:hover {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            transform: scale(1.05);
        }

        .stop-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }

        .stop-btn:hover {
            background: linear-gradient(135deg, #c0392b, #e74c3c);
            transform: scale(1.05);
        }

        .status-bar {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .status-item {
            display: flex;
            align-items: center;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-active {
            background: #2ecc71;
            box-shadow: 0 0 10px #2ecc71;
        }

        .status-inactive {
            background: #e74c3c;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            color: #a0a0c0;
            font-size: 0.9rem;
        }

        /* ‰∏ì‰∏öÊ®°ÂºèÁâπÂÆöÊ†∑Âºè */
        .pro-mode .channel {
            width: 160px;
        }

        .pro-mode .control-label {
            font-size: 0.7rem;
        }

        .pro-mode .channel-btn {
            font-size: 0.65rem;
            padding: 5px 8px;
        }

        .pro-mode .drop-zone {
            font-size: 0.6rem;
            height: 45px;
        }

        .pro-mode .mic-btn {
            font-size: 0.65rem;
            padding: 5px 8px;
        }

        /* Êñ∞ÊâãÊ®°ÂºèÁâπÂÆöÊ†∑Âºè */
        .beginner-mode .channel {
            width: 180px;
        }

        .beginner-mode .control-label {
            font-size: 0.8rem;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 1200px) {
            .mixer-container {
                flex-direction: column;
            }
            
            .channels-container {
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .channel {
                width: 150px;
            }
            
            header {
                flex-direction: column;
                gap: 15px;
            }
            
            .mode-selector {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‰∏ì‰∏öÈü≥È¢ëË∞ÉÈü≥Âè∞Ê®°ÊãüÂô®</h1>
            <div class="mode-selector">
                <button class="mode-btn active" id="beginner-mode-btn">Êñ∞ÊâãÊ®°Âºè</button>
                <button class="mode-btn" id="pro-mode-btn">‰∏ì‰∏öÊ®°Âºè</button>
            </div>
        </header>

        <div class="mixer-container beginner-mode" id="mixer-container">
            <div class="channels-section">
                <div class="channels-container" id="channels-container">
                    <!-- ÈÄöÈÅìÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
            </div>
            
            <div class="master-section">
                <h2 class="master-title">‰∏ªÊéß</h2>
                <div class="master-controls">
                    <div class="control-group">
                        <div class="control-label">‰∏ªÈü≥Èáè</div>
                        <div class="master-fader">
                            <div class="master-fader-track">
                                <div class="master-fader-thumb" id="master-fader-thumb" style="top: 30%;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="filter-section">
                        <h3 class="filter-title">Êª§Ê≥¢Âô®</h3>
                        <div class="filter-controls">
                            <div class="filter-slider">
                                <label for="filter-freq">È¢ëÁéá:</label>
                                <input type="range" min="20" max="20000" value="1000" id="filter-freq">
                                <span id="filter-freq-value">1000 Hz</span>
                            </div>
                            <div class="filter-slider">
                                <label for="filter-q">QÂÄº:</label>
                                <input type="range" min="0.1" max="10" value="1" step="0.1" id="filter-q">
                                <span id="filter-q-value">1.0</span>
                            </div>
                            <div class="filter-slider">
                                <label for="filter-type">Á±ªÂûã:</label>
                                <select id="filter-type">
                                    <option value="lowpass">‰ΩéÈÄö</option>
                                    <option value="highpass">È´òÈÄö</option>
                                    <option value="bandpass">Â∏¶ÈÄö</option>
                                    <option value="lowshelf">‰ΩéÊû∂</option>
                                    <option value="highshelf">È´òÊû∂</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="eq-section">
                        <h3 class="eq-title">ÂùáË°°Âô®</h3>
                        <div class="eq-bands">
                            <div class="eq-band">
                                <div class="control-label">‰ΩéÈ¢ë</div>
                                <div class="fader">
                                    <div class="fader-track">
                                        <div class="fader-thumb" id="eq-low-thumb" style="top: 50%;"></div>
                                    </div>
                                </div>
                                <span id="eq-low-value">0 dB</span>
                            </div>
                            <div class="eq-band">
                                <div class="control-label">‰∏≠È¢ë</div>
                                <div class="fader">
                                    <div class="fader-track">
                                        <div class="fader-thumb" id="eq-mid-thumb" style="top: 50%;"></div>
                                    </div>
                                </div>
                                <span id="eq-mid-value">0 dB</span>
                            </div>
                            <div class="eq-band">
                                <div class="control-label">È´òÈ¢ë</div>
                                <div class="fader">
                                    <div class="fader-track">
                                        <div class="fader-thumb" id="eq-high-thumb" style="top: 50%;"></div>
                                    </div>
                                </div>
                                <span id="eq-high-value">0 dB</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="gain-section">
                        <h3 class="gain-title">Â¢ûÁõä</h3>
                        <div class="gain-controls">
                            <div class="gain-slider">
                                <label for="master-gain">Â¢ûÁõä:</label>
                                <input type="range" min="-20" max="20" value="0" id="master-gain">
                                <span id="master-gain-value">0 dB</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="transport-controls">
                        <button class="transport-btn play-btn" id="play-btn">
                            <i class="fas fa-play"></i> Êí≠ÊîæÂÖ®ÈÉ®
                        </button>
                        <button class="transport-btn stop-btn" id="stop-btn">
                            <i class="fas fa-stop"></i> ÂÅúÊ≠¢ÂÖ®ÈÉ®
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <div class="status-indicator status-active" id="audio-status"></div>
                <span id="audio-status-text">Èü≥È¢ëÁ≥ªÁªü: Â∞±Áª™</span>
            </div>
            <div class="status-item">
                <div class="status-indicator status-inactive" id="playback-status"></div>
                <span id="playback-status-text">Êí≠ÊîæÁä∂ÊÄÅ: ÂÅúÊ≠¢</span>
            </div>
            <div class="status-item">
                <span>Ê¥ªÂä®ÈÄöÈÅì: <span id="active-channels">0</span>/8</span>
            </div>
            <div class="status-item">
                <span>ÈááÊ†∑Áéá: 48kHz | ‰ΩçÊ∑±Â∫¶: 24-bit</span>
            </div>
        </div>

        <footer>
            <p>‰∏ì‰∏öÈü≥È¢ëË∞ÉÈü≥Âè∞Ê®°ÊãüÂô® &copy; 2023 | ÊîØÊåÅÂ§öÈÄöÈÅìÊ∑∑Èü≥„ÄÅÂùáË°°Âô®„ÄÅÊª§Ê≥¢Âô®ÂíåÂΩïÈü≥ÂäüËÉΩ</p>
        </footer>
    </div>

    <script>
        // ÂÖ®Â±ÄÂèòÈáè
        let audioContext;
        let masterGainNode;
        let filterNode;
        let eqLowNode, eqMidNode, eqHighNode;
        let isPlaying = false;
        let channels = {};
        let currentMode = 'beginner';
        
        // Âà†Èô§ÂΩïÈü≥Áõ∏ÂÖ≥ÁöÑÂÖ®Â±ÄÂèòÈáè
        let mediaRecorder;
        let recordedChunks = [];
        let isRecording = false;
        let recordingStartTime;
        let recordingTimer;
        let recordedClips = [];

        // ÂàùÂßãÂåñÈü≥È¢ë‰∏ä‰∏ãÊñá
        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // ÂàõÂª∫‰∏ªÂ¢ûÁõäËäÇÁÇπ
                masterGainNode = audioContext.createGain();
                masterGainNode.gain.value = 0.8;
                
                // ÂàõÂª∫Êª§Ê≥¢Âô®
                filterNode = audioContext.createBiquadFilter();
                filterNode.type = 'lowpass';
                filterNode.frequency.value = 1000;
                filterNode.Q.value = 1;
                
                // ÂàõÂª∫EQËäÇÁÇπ
                eqLowNode = audioContext.createBiquadFilter();
                eqLowNode.type = 'lowshelf';
                eqLowNode.frequency.value = 250;
                eqLowNode.gain.value = 0;
                
                eqMidNode = audioContext.createBiquadFilter();
                eqMidNode.type = 'peaking';
                eqMidNode.frequency.value = 1000;
                eqMidNode.Q.value = 1;
                eqMidNode.gain.value = 0;
                
                eqHighNode = audioContext.createBiquadFilter();
                eqHighNode.type = 'highshelf';
                eqHighNode.frequency.value = 4000;
                eqHighNode.gain.value = 0;
                
                // ËøûÊé•ËäÇÁÇπ: Êª§Ê≥¢Âô® -> EQ -> ‰∏ªÂ¢ûÁõä -> ËæìÂá∫
                filterNode.connect(eqLowNode);
                eqLowNode.connect(eqMidNode);
                eqMidNode.connect(eqHighNode);
                eqHighNode.connect(masterGainNode);
                masterGainNode.connect(audioContext.destination);
                
                // ÂàùÂßãÂåñÊâÄÊúâÈÄöÈÅì
                for (let i = 1; i <= 8; i++) {
                    const channelId = `ch${i}`;
                    channels[channelId] = {
                        audioBuffer: null,
                        source: null,
                        gainNode: null,
                        panNode: null,
                        analyser: null,
                        isMuted: false,
                        isSolo: false,
                        isPlaying: false,
                        isMic: false,
                        file: null,
                        eqLowNode: null,
                        eqMidNode: null,
                        eqHighNode: null,
                        filterNode: null
                    };
                    
                    // ÂàõÂª∫ÂàÜÊûêÂô®Áî®‰∫éÁîµÂπ≥Ë°®
                    channels[channelId].analyser = audioContext.createAnalyser();
                    channels[channelId].analyser.fftSize = 32;
                    
                    // ÂàõÂª∫ÈÄöÈÅìEQËäÇÁÇπ
                    channels[channelId].eqLowNode = audioContext.createBiquadFilter();
                    channels[channelId].eqLowNode.type = 'lowshelf';
                    channels[channelId].eqLowNode.frequency.value = 250;
                    channels[channelId].eqLowNode.gain.value = 0;
                    
                    channels[channelId].eqMidNode = audioContext.createBiquadFilter();
                    channels[channelId].eqMidNode.type = 'peaking';
                    channels[channelId].eqMidNode.frequency.value = 1000;
                    channels[channelId].eqMidNode.Q.value = 1;
                    channels[channelId].eqMidNode.gain.value = 0;
                    
                    channels[channelId].eqHighNode = audioContext.createBiquadFilter();
                    channels[channelId].eqHighNode.type = 'highshelf';
                    channels[channelId].eqHighNode.frequency.value = 4000;
                    channels[channelId].eqHighNode.gain.value = 0;
                    
                    // ÂàõÂª∫ÈÄöÈÅìÊª§Ê≥¢Âô®
                    channels[channelId].filterNode = audioContext.createBiquadFilter();
                    channels[channelId].filterNode.type = 'lowpass';
                    channels[channelId].filterNode.frequency.value = 1000;
                    channels[channelId].filterNode.Q.value = 1;
                }
                
                updateAudioStatus(true, "Èü≥È¢ëÁ≥ªÁªü: Â∞±Áª™");
                console.log("Èü≥È¢ëÁ≥ªÁªüÂàùÂßãÂåñÊàêÂäü");
                
                // ÂàùÂßãÂåñ‰∏ªÊéßÊé®Â≠ê
                initMasterFader();
                
                // ÂàùÂßãÂåñÊª§Ê≥¢Âô®ÊéßÂà∂
                initFilterControls();
                
                // ÂàùÂßãÂåñEQÊéßÂà∂
                initEQControls();
                
                // ÂàùÂßãÂåñÂ¢ûÁõäÊéßÂà∂
                initGainControls();
            } catch (error) {
                console.error("Èü≥È¢ëÁ≥ªÁªüÂàùÂßãÂåñÂ§±Ë¥•:", error);
                updateAudioStatus(false, "Èü≥È¢ëÁ≥ªÁªü: ÈîôËØØ");
            }
        }

        // ÂàùÂßãÂåñ‰∏ªÊéßÊé®Â≠ê
        function initMasterFader() {
            const faderThumb = document.getElementById('master-fader-thumb');
            const track = document.querySelector('.master-fader-track');
            
            let isDragging = false;
            
            const updateThumbPosition = (y) => {
                const trackRect = track.getBoundingClientRect();
                let newTop = y - trackRect.top;
                
                // ÈôêÂà∂Âú®ËΩ®ÈÅìËåÉÂõ¥ÂÜÖ
                newTop = Math.max(0, Math.min(newTop, trackRect.height));
                
                // Êõ¥Êñ∞ÊãáÊåá‰ΩçÁΩÆ
                faderThumb.style.top = `${newTop}px`;
                
                // ËÆ°ÁÆóÂÄºÔºà0-1Ôºâ
                const value = 1 - (newTop / trackRect.height);
                
                // Êõ¥Êñ∞‰∏ªÂ¢ûÁõä
                masterGainNode.gain.value = value;
            };
            
            faderThumb.addEventListener('mousedown', (e) => {
                isDragging = true;
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    updateThumbPosition(e.clientY);
                }
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
            
            track.addEventListener('click', (e) => {
                updateThumbPosition(e.clientY);
            });
        }

        // ÂàùÂßãÂåñÊª§Ê≥¢Âô®ÊéßÂà∂
        function initFilterControls() {
            const filterFreq = document.getElementById('filter-freq');
            const filterQ = document.getElementById('filter-q');
            const filterType = document.getElementById('filter-type');
            const filterFreqValue = document.getElementById('filter-freq-value');
            const filterQValue = document.getElementById('filter-q-value');
            
            filterFreq.addEventListener('input', (e) => {
                filterNode.frequency.value = e.target.value;
                filterFreqValue.textContent = `${e.target.value} Hz`;
            });
            
            filterQ.addEventListener('input', (e) => {
                filterNode.Q.value = e.target.value;
                filterQValue.textContent = e.target.value;
            });
            
            filterType.addEventListener('change', (e) => {
                filterNode.type = e.target.value;
            });
        }

        // ÂàùÂßãÂåñEQÊéßÂà∂
        function initEQControls() {
            const eqLowThumb = document.getElementById('eq-low-thumb');
            const eqMidThumb = document.getElementById('eq-mid-thumb');
            const eqHighThumb = document.getElementById('eq-high-thumb');
            const eqLowValue = document.getElementById('eq-low-value');
            const eqMidValue = document.getElementById('eq-mid-value');
            const eqHighValue = document.getElementById('eq-high-value');
            
            // ‰ΩéÈ¢ëEQÊéßÂà∂
            initEQFader(eqLowThumb, eqLowNode, eqLowValue, -20, 20);
            
            // ‰∏≠È¢ëEQÊéßÂà∂
            initEQFader(eqMidThumb, eqMidNode, eqMidValue, -20, 20);
            
            // È´òÈ¢ëEQÊéßÂà∂
            initEQFader(eqHighThumb, eqHighNode, eqHighValue, -20, 20);
        }
        
        // ÂàùÂßãÂåñEQÊé®Â≠ê
        function initEQFader(thumb, node, valueDisplay, min, max) {
            const track = thumb.parentElement;
            
            let isDragging = false;
            
            const updateThumbPosition = (y) => {
                const trackRect = track.getBoundingClientRect();
                let newTop = y - trackRect.top;
                
                // ÈôêÂà∂Âú®ËΩ®ÈÅìËåÉÂõ¥ÂÜÖ
                newTop = Math.max(0, Math.min(newTop, trackRect.height));
                
                // Êõ¥Êñ∞ÊãáÊåá‰ΩçÁΩÆ
                thumb.style.top = `${newTop}px`;
                
                // ËÆ°ÁÆóÂÄºÔºàmin-maxÔºâ
                const valueRange = max - min;
                const value = min + (valueRange * (1 - (newTop / trackRect.height)));
                
                // Êõ¥Êñ∞EQËäÇÁÇπÂ¢ûÁõä
                node.gain.value = value;
                
                // Êõ¥Êñ∞ÊòæÁ§∫ÂÄº
                valueDisplay.textContent = `${value > 0 ? '+' : ''}${value.toFixed(1)} dB`;
            };
            
            thumb.addEventListener('mousedown', (e) => {
                isDragging = true;
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    updateThumbPosition(e.clientY);
                }
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
            
            track.addEventListener('click', (e) => {
                updateThumbPosition(e.clientY);
            });
        }

        // ÂàùÂßãÂåñÂ¢ûÁõäÊéßÂà∂
        function initGainControls() {
            const masterGain = document.getElementById('master-gain');
            const masterGainValue = document.getElementById('master-gain-value');
            
            masterGain.addEventListener('input', (e) => {
                const db = parseInt(e.target.value);
                masterGainValue.textContent = `${db > 0 ? '+' : ''}${db} dB`;
                
                // Â∞ÜdBÂÄºËΩ¨Êç¢‰∏∫Á∫øÊÄßÂ¢ûÁõäÂÄº
                const linearGain = Math.pow(10, db / 20);
                masterGainNode.gain.value = linearGain;
            });
        }

        // Êõ¥Êñ∞Èü≥È¢ëÁä∂ÊÄÅ
        function updateAudioStatus(active, text) {
            const statusIndicator = document.getElementById('audio-status');
            const statusText = document.getElementById('audio-status-text');
            
            if (active) {
                statusIndicator.className = 'status-indicator status-active';
            } else {
                statusIndicator.className = 'status-indicator status-inactive';
            }
            
            statusText.textContent = text;
        }

        // ÁîüÊàêÈÄöÈÅìHTML
        function generateChannels() {
            const channelsContainer = document.getElementById('channels-container');
            channelsContainer.innerHTML = '';
            
            for (let i = 1; i <= 8; i++) {
                const channelId = `ch${i}`;
                const channelHTML = `
                    <div class="channel" id="${channelId}">
                        <div class="channel-header">
                            <div class="channel-title">${currentMode === 'pro' ? 'CH' : 'ÈÄöÈÅì'} ${i}</div>
                            <div class="channel-meter">
                                <div class="channel-meter-level" id="meter-${channelId}"></div>
                            </div>
                        </div>
                        <div class="input-source">
                            <div class="drop-zone" data-channel="${channelId}">
                                <div class="file-icon">üìÅ</div>
                                <p>${currentMode === 'pro' ? 'Drop File' : 'ÊãñÊîæÊñá‰ª∂'}</p>
                            </div>
                            <button class="mic-btn" data-channel="${channelId}">${currentMode === 'pro' ? 'MIC' : 'È∫¶ÂÖãÈ£é'}</button>
                        </div>
                        <div class="channel-controls">
                            ${currentMode === 'pro' ? `
                                <div class="control-group">
                                    <div class="control-label">HPF</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 80%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">GATE</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 70%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">COMP</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 60%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">EQ LOW</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 50%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">EQ MID</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 50%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">EQ HIGH</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 50%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">PAN</div>
                                    <div class="knob">
                                        <div class="knob-dial">
                                            <div class="knob-indicator" style="transform: translateX(-50%) rotate(0deg);"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">FADER</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 70%;"></div>
                                        </div>
                                    </div>
                                </div>
                            ` : `
                                <div class="control-group">
                                    <div class="control-label">Èü≥Èáè</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 70%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">Â£∞ÂÉè</div>
                                    <div class="knob">
                                        <div class="knob-dial">
                                            <div class="knob-indicator" style="transform: translateX(-50%) rotate(0deg);"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">È´òÈÄöÊª§Ê≥¢</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 80%;"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <div class="control-label">ÂùáË°°Âô®</div>
                                    <div class="fader">
                                        <div class="fader-track">
                                            <div class="fader-thumb" style="top: 50%;"></div>
                                        </div>
                                    </div>
                                </div>
                            `}
                            <div class="button-group">
                                <button class="channel-btn" data-channel="${channelId}" data-action="mute">
                                    ${currentMode === 'pro' ? 'MUTE' : 'ÈùôÈü≥'}
                                </button>
                                <button class="channel-btn" data-channel="${channelId}" data-action="solo">
                                    ${currentMode === 'pro' ? 'SOLO' : 'Áã¨Â•è'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                channelsContainer.innerHTML += channelHTML;
            }
            
            // Ê∑ªÂä†ÈÄöÈÅìÊåâÈíÆ‰∫ã‰ª∂ÁõëÂê¨Âô®
            document.querySelectorAll('.channel-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const channel = e.target.getAttribute('data-channel');
                    const action = e.target.getAttribute('data-action');
                    
                    handleChannelAction(channel, action, e.target);
                });
            });
            
            // Ê∑ªÂä†Êñá‰ª∂ÊãñÊîæÂäüËÉΩ
            initDragAndDrop();
            
            // Ê∑ªÂä†È∫¶ÂÖãÈ£éÊåâÈíÆ‰∫ã‰ª∂
            initMicButtons();
            
            // Ê∑ªÂä†Êé®Â≠êÊãñÂä®ÂäüËÉΩ
            initFaders();
        }

        // ÂàùÂßãÂåñÊñá‰ª∂ÊãñÊîæÂäüËÉΩ
        function initDragAndDrop() {
            const dropZones = document.querySelectorAll('.drop-zone');
            
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.style.backgroundColor = 'rgba(76, 175, 80, 0.2)';
                });
                
                zone.addEventListener('dragleave', () => {
                    zone.style.backgroundColor = '';
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.style.backgroundColor = '';
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        const channel = zone.getAttribute('data-channel');
                        handleFileUpload(files[0], channel);
                    }
                });
                
                // ÁÇπÂáª‰∏ä‰º†
                zone.addEventListener('click', (e) => {
                    if (e.target.tagName !== 'BUTTON') {
                        const input = document.createElement('input');
                        input.type = 'file';
                        input.accept = 'audio/*';
                        input.onchange = (e) => {
                            const files = e.target.files;
                            if (files.length > 0) {
                                const channel = zone.getAttribute('data-channel');
                                handleFileUpload(files[0], channel);
                            }
                        };
                        input.click();
                    }
                });
            });
        }

        // Â§ÑÁêÜÊñá‰ª∂‰∏ä‰º†
        function handleFileUpload(file, channel) {
            if (!file.type.match('audio.*')) {
                alert('ËØ∑ÈÄâÊã©Èü≥È¢ëÊñá‰ª∂ÔºÅ');
                return;
            }
            
            // Êõ¥Êñ∞UIÊòæÁ§∫Êñá‰ª∂Â∑≤Âä†ËΩΩ
            const dropZone = document.querySelector(`.drop-zone[data-channel="${channel}"]`);
            dropZone.innerHTML = `<div class="file-icon">‚úÖ</div><p>${file.name.substring(0, 10)}...</p>`;
            
            // ÂàõÂª∫ÂØπË±°URLÁî®‰∫éÊí≠Êîæ
            const objectUrl = URL.createObjectURL(file);
            
            // ‰ΩøÁî®AudioÂÖÉÁ¥†Ëß£Á†Å
            const audio = new Audio();
            audio.src = objectUrl;
            
            // ‰ΩøÁî®OfflineAudioContextËß£Á†ÅÈü≥È¢ë
            const reader = new FileReader();
            reader.onload = function(e) {
                audioContext.decodeAudioData(e.target.result, function(buffer) {
                    channels[channel].audioBuffer = buffer;
                    channels[channel].isMic = false;
                    channels[channel].file = file;
                    updateActiveChannels();
                    console.log(`Èü≥È¢ëÂ∑≤Âä†ËΩΩÂà∞ ${channel}`);
                }, function(e) {
                    console.error("Ëß£Á†ÅÈü≥È¢ëÊï∞ÊçÆÊó∂Âá∫Èîô", e);
                });
            };
            reader.readAsArrayBuffer(file);
        }

        // ÂàùÂßãÂåñÈ∫¶ÂÖãÈ£éÊåâÈíÆ
        function initMicButtons() {
            document.querySelectorAll('.mic-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const channel = e.target.getAttribute('data-channel');
                    if (channels[channel].isMic && channels[channel].isPlaying) {
                        stopChannel(channel);
                        e.target.classList.remove('active');
                        const dropZone = document.querySelector(`.drop-zone[data-channel="${channel}"]`);
                        dropZone.innerHTML = `<div class="file-icon">üìÅ</div><p>${currentMode === 'pro' ? 'Drop File' : 'ÊãñÊîæÊñá‰ª∂'}</p>`;
                        channels[channel].isMic = false;
                    } else {
                        initMicrophone(channel);
                        e.target.classList.add('active');
                    }
                    updateActiveChannels();
                });
            });
        }

        // ÂàùÂßãÂåñÈ∫¶ÂÖãÈ£éËæìÂÖ•
        function initMicrophone(channel) {
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                navigator.mediaDevices.getUserMedia({ audio: true })
                .then(stream => {
                    const source = audioContext.createMediaStreamSource(stream);
                    const gainNode = audioContext.createGain();
                    const panNode = audioContext.createStereoPanner();
                    
                    // ËÆæÁΩÆÂàùÂßãÂÄº
                    gainNode.gain.value = 0.7;
                    panNode.pan.value = 0;
                    
                    // ËøûÊé•ËäÇÁÇπ: Ê∫ê -> ÈÄöÈÅìEQ -> ÈÄöÈÅìÊª§Ê≥¢Âô® -> Â£∞ÂÉè -> Â¢ûÁõä -> ÂàÜÊûêÂô® -> ‰∏ªÊéß
                    source.connect(channels[channel].eqLowNode);
                    channels[channel].eqLowNode.connect(channels[channel].eqMidNode);
                    channels[channel].eqMidNode.connect(channels[channel].eqHighNode);
                    channels[channel].eqHighNode.connect(channels[channel].filterNode);
                    channels[channel].filterNode.connect(panNode);
                    panNode.connect(gainNode);
                    gainNode.connect(channels[channel].analyser);
                    channels[channel].analyser.connect(filterNode);
                    
                    channels[channel].source = source;
                    channels[channel].gainNode = gainNode;
                    channels[channel].panNode = panNode;
                    channels[channel].isPlaying = true;
                    channels[channel].isMic = true;
                    
                    // Êõ¥Êñ∞UI
                    const dropZone = document.querySelector(`.drop-zone[data-channel="${channel}"]`);
                    dropZone.innerHTML = `<div class="file-icon">üé§</div><p>${currentMode === 'pro' ? 'MIC Active' : 'È∫¶ÂÖãÈ£é‰ΩøÁî®‰∏≠'}</p>`;
                    
                    updatePlaybackStatus();
                    console.log(`È∫¶ÂÖãÈ£éËøûÊé•Âà∞ ${channel}`);
                })
                .catch(error => {
                    console.error('ËÆøÈóÆÈ∫¶ÂÖãÈ£éÊó∂Âá∫Èîô:', error);
                    alert('Êó†Ê≥ïËÆøÈóÆÈ∫¶ÂÖãÈ£é„ÄÇËØ∑Á°Æ‰øùÂ∑≤Êéà‰∫àÈ∫¶ÂÖãÈ£éÊùÉÈôê„ÄÇ');
                });
            } else {
                console.error('getUserMedia ‰∏çÊîØÊåÅ');
                alert('ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅÈ∫¶ÂÖãÈ£éËÆøÈóÆ„ÄÇ');
            }
        }

        // Â§ÑÁêÜÈÄöÈÅìÊåâÈíÆÂä®‰Ωú
        function handleChannelAction(channel, action, button) {
            switch(action) {
                case 'mute':
                    channels[channel].isMuted = !channels[channel].isMuted;
                    button.classList.toggle('active', channels[channel].isMuted);
                    if (channels[channel].gainNode) {
                        channels[channel].gainNode.gain.value = channels[channel].isMuted ? 0 : 0.7;
                    }
                    break;
                case 'solo':
                    channels[channel].isSolo = !channels[channel].isSolo;
                    button.classList.toggle('active', channels[channel].isSolo);
                    // ÂÆûÁé∞Áã¨Â•èÈÄªËæëÔºàÁÆÄÂåñÁâàÔºâ
                    Object.keys(channels).forEach(ch => {
                        if (ch !== channel && channels[ch].gainNode) {
                            channels[ch].gainNode.gain.value = channels[channel].isSolo ? 0 : 0.7;
                        }
                    });
                    break;
            }
        }

        // ÂàùÂßãÂåñÊé®Â≠êÊãñÂä®ÂäüËÉΩ
        function initFaders() {
            document.querySelectorAll('.fader').forEach(fader => {
                const track = fader.querySelector('.fader-track');
                const thumb = fader.querySelector('.fader-thumb');
                
                let isDragging = false;
                
                const updateThumbPosition = (y) => {
                    const trackRect = track.getBoundingClientRect();
                    let newTop = y - trackRect.top;
                    
                    // ÈôêÂà∂Âú®ËΩ®ÈÅìËåÉÂõ¥ÂÜÖ
                    newTop = Math.max(0, Math.min(newTop, trackRect.height));
                    
                    // Êõ¥Êñ∞ÊãáÊåá‰ΩçÁΩÆ
                    thumb.style.top = `${newTop}px`;
                    
                    // ËÆ°ÁÆóÂÄºÔºà0-1Ôºâ
                    const value = 1 - (newTop / trackRect.height);
                    
                    // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†ÂÆûÈôÖÊéßÂà∂Èü≥È¢ëËäÇÁÇπÁöÑ‰ª£Á†Å
                    console.log(`Fader value: ${value.toFixed(2)}`);
                };
                
                thumb.addEventListener('mousedown', (e) => {
                    isDragging = true;
                    e.preventDefault();
                });
                
                document.addEventListener('mousemove', (e) => {
                    if (isDragging) {
                        updateThumbPosition(e.clientY);
                    }
                });
                
                document.addEventListener('mouseup', () => {
                    isDragging = false;
                });
                
                track.addEventListener('click', (e) => {
                    updateThumbPosition(e.clientY);
                });
            });
        }

        // Êõ¥Êñ∞Ê¥ªÂä®ÈÄöÈÅìËÆ°Êï∞
        function updateActiveChannels() {
            let activeCount = 0;
            for (let i = 1; i <= 8; i++) {
                const channelId = `ch${i}`;
                if (channels[channelId].audioBuffer || channels[channelId].isMic) {
                    activeCount++;
                }
            }
            document.getElementById('active-channels').textContent = activeCount;
        }

        // Êõ¥Êñ∞ÁîµÂπ≥Ë°®
        function updateMeters() {
            for (let i = 1; i <= 8; i++) {
                const channelId = `ch${i}`;
                const meter = document.getElementById(`meter-${channelId}`);
                
                // Ê®°ÊãüÁîµÂπ≥Ë°®Âä®Áîª
                if (channels[channelId].isPlaying) {
                    const randomLevel = Math.random() * 80 + 10; // 10-90%
                    meter.style.height = `${randomLevel}%`;
                } else {
                    meter.style.height = '0%';
                }
            }
            
            requestAnimationFrame(updateMeters);
        }

        // Êí≠Êîæ/ÂÅúÊ≠¢Èü≥È¢ë
        function playAllChannels() {
            if (isPlaying) return;
            
            Object.keys(channels).forEach(channel => {
                if (!channels[channel].isPlaying && channels[channel].audioBuffer) {
                    // ÂàõÂª∫Èü≥È¢ëÊ∫ê
                    const source = audioContext.createBufferSource();
                    source.buffer = channels[channel].audioBuffer;
                    source.loop = true;
                    
                    // ÂàõÂª∫Â¢ûÁõäËäÇÁÇπ
                    const gainNode = audioContext.createGain();
                    gainNode.gain.value = channels[channel].isMuted ? 0 : 0.7;
                    
                    // ÂàõÂª∫Â£∞ÂÉèËäÇÁÇπ
                    const panNode = audioContext.createStereoPanner();
                    panNode.pan.value = 0;
                    
                    // ËøûÊé•ËäÇÁÇπ: Ê∫ê -> ÈÄöÈÅìEQ -> ÈÄöÈÅìÊª§Ê≥¢Âô® -> Â£∞ÂÉè -> Â¢ûÁõä -> ÂàÜÊûêÂô® -> ‰∏ªÊéß
                    source.connect(channels[channel].eqLowNode);
                    channels[channel].eqLowNode.connect(channels[channel].eqMidNode);
                    channels[channel].eqMidNode.connect(channels[channel].eqHighNode);
                    channels[channel].eqHighNode.connect(channels[channel].filterNode);
                    channels[channel].filterNode.connect(panNode);
                    panNode.connect(gainNode);
                    gainNode.connect(channels[channel].analyser);
                    channels[channel].analyser.connect(filterNode);
                    
                    // ‰øùÂ≠òÂºïÁî®
                    channels[channel].source = source;
                    channels[channel].gainNode = gainNode;
                    channels[channel].panNode = panNode;
                    channels[channel].isPlaying = true;
                    
                    // ÂºÄÂßãÊí≠Êîæ
                    source.start();
                }
            });
            
            isPlaying = true;
            updatePlaybackStatus();
        }

        function stopAllChannels() {
            Object.keys(channels).forEach(channel => {
                if (channels[channel].isPlaying && channels[channel].source && !channels[channel].isMic) {
                    channels[channel].source.stop();
                    channels[channel].isPlaying = false;
                }
            });
            
            isPlaying = false;
            updatePlaybackStatus();
        }

        function stopChannel(channel) {
            if (channels[channel].isMic) {
                // ÂØπ‰∫éÈ∫¶ÂÖãÈ£éÔºåÊàë‰ª¨Âè™ÊòØÊñ≠ÂºÄËøûÊé•Ôºå‰∏çÂÅúÊ≠¢ÊµÅ
                if (channels[channel].source) {
                    channels[channel].source.disconnect();
                    channels[channel].source = null;
                    channels[channel].isPlaying = false;
                }
            } else if (channels[channel].source && channels[channel].isPlaying) {
                channels[channel].source.stop();
                channels[channel].isPlaying = false;
            }
            
            updatePlaybackStatus();
        }

        // Êõ¥Êñ∞Êí≠ÊîæÁä∂ÊÄÅ
        function updatePlaybackStatus() {
            const statusIndicator = document.getElementById('playback-status');
            const statusText = document.getElementById('playback-status-text');
            
            let anyPlaying = false;
            for (let i = 1; i <= 8; i++) {
                const channelId = `ch${i}`;
                if (channels[channelId].isPlaying) {
                    anyPlaying = true;
                    break;
                }
            }
            
            if (anyPlaying) {
                statusIndicator.className = 'status-indicator status-active';
                statusText.textContent = 'Êí≠ÊîæÁä∂ÊÄÅ: Êí≠Êîæ‰∏≠';
                isPlaying = true;
            } else {
                statusIndicator.className = 'status-indicator status-inactive';
                statusText.textContent = 'Êí≠ÊîæÁä∂ÊÄÅ: ÂÅúÊ≠¢';
                isPlaying = false;
            }
            
            // Êõ¥Êñ∞Ê¥ªÂä®ÈÄöÈÅìËÆ°Êï∞
            let activeCount = 0;
            Object.keys(channels).forEach(channel => {
                if (channels[channel].isPlaying) activeCount++;
            });
            document.getElementById('active-channels').textContent = activeCount;
        }

        // Âà†Èô§ÂΩïÈü≥Áõ∏ÂÖ≥ÁöÑÂàùÂßãÂåñ‰ª£Á†Å
        function initRecording() {
            // ‰∏çÂÜçÈúÄË¶ÅÂΩïÈü≥ÂàùÂßãÂåñ
        }

        // Âà†Èô§ÂΩïÈü≥Áõ∏ÂÖ≥ÁöÑÂáΩÊï∞
        function startRecording() {
            // ‰∏çÂÜçÈúÄË¶ÅÂΩïÈü≥ÂäüËÉΩ
        }

        function stopRecording() {
            // ‰∏çÂÜçÈúÄË¶ÅÂΩïÈü≥ÂäüËÉΩ
        }

        function playRecorded() {
            // ‰∏çÂÜçÈúÄË¶ÅÂΩïÈü≥ÂäüËÉΩ
        }

        // Ê®°ÂºèÂàáÊç¢
        function initModeSwitcher() {
            const beginnerBtn = document.getElementById('beginner-mode-btn');
            const proBtn = document.getElementById('pro-mode-btn');
            const mixerContainer = document.getElementById('mixer-container');
            
            beginnerBtn.addEventListener('click', () => {
                if (currentMode === 'pro') {
                    currentMode = 'beginner';
                    mixerContainer.className = 'mixer-container beginner-mode';
                    beginnerBtn.classList.add('active');
                    proBtn.classList.remove('active');
                    generateChannels();
                }
            });
            
            proBtn.addEventListener('click', () => {
                if (currentMode === 'beginner') {
                    currentMode = 'pro';
                    mixerContainer.className = 'mixer-container pro-mode';
                    proBtn.classList.add('active');
                    beginnerBtn.classList.remove('active');
                    generateChannels();
                }
            });
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            initAudio();
            generateChannels();
            initModeSwitcher();
            initRecording();
            updateMeters();
            
            // Êí≠Êîæ/ÂÅúÊ≠¢ÊåâÈíÆ‰∫ã‰ª∂
            document.getElementById('play-btn').addEventListener('click', playAllChannels);
            document.getElementById('stop-btn').addEventListener('click', stopAllChannels);
        });
    </script>
</body>
</html>